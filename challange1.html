<!DOCTYPE html>
<html lang="sq">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sfida 1: Variablat | MÃ«so Programimin</title>

  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/challanges.css" />
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>

  <style>
    /* Notification styling */
    .notification {
      position: fixed;
      top: 80px;
      right: 20px;
      background: #ff4444;
      color: #fff;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 600;
      opacity: 0;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      z-index: 9999;
    }
    .notification.show {
      opacity: 1;
      transform: translateY(0);
    }
    .notification.success {
      background: #00c985;
    }
    .show-answer-btn {
      display: none;
      background: #555;
      color: #fff;
      padding: 8px 16px;
      border-radius: 6px;
      margin-top: 12px;
      cursor: pointer;
      border: none;
      transition: 0.2s;
    }
    .show-answer-btn:hover {
      background: #777;
    }
  </style>
</head>

<body>
  <header class="navbar">
    <div class="navbar-left">
      <img src="imgs/coding-removebg-preview.png" alt="Logo" class="logo-icon" />
      <span class="logo-text">MÃ«so Programimin</span>
    </div>
  </header>

  <!-- Notification -->
  <div id="notification" class="notification"></div>

  <main class="challenge-container vertical-layout">
    <section class="instructions-top">
      <h2 class="challenge-title">ğŸ§  Sfida 1: Variablat</h2>
      <p>
        Tani qÃ« ke mÃ«suar pÃ«r <strong>variablat</strong>, Ã«shtÃ« koha tâ€™i pÃ«rdorÃ«sh ato vetÃ«!
      </p>
      <p>
        <strong>Detyra:</strong><br>
        1ï¸âƒ£ Krijo njÃ« variabÃ«l me emrin <code>emri</code> dhe cakto vlerÃ«n tÃ«nde (p.sh. "Alban").<br>
        2ï¸âƒ£ Krijo njÃ« tjetÃ«r variabÃ«l <code>vendi</code> dhe cakto vlerÃ«n "KosovÃ«".<br>
        3ï¸âƒ£ PÃ«rdor <code>console.log()</code> pÃ«r tâ€™i shfaqur tÃ« dyja nÃ« ekran.
      </p>
      <p>
        Kur tÃ« jesh gati, kliko <strong>â€œEkzekuto Kodinâ€</strong> pÃ«r ta testuar zgjidhjen tÃ«nde.
      </p>

      <div class="lesson-nav top-nav">
        <a href="lesson1.html" class="nav-btn back-btn">â† Kthehu te MÃ«simi</a>
      </div>
    </section>

    <section class="editor-bottom">
      <h2 class="challenge-title">ğŸ’» Shkruaj Kodin TÃ«nd</h2>

      <div id="editor" class="monaco-editor"></div>
      <button id="run-btn">Ekzekuto Kodin</button>
      <div id="output"></div>

      <button id="showAnswerBtn" class="show-answer-btn">Shiko zgjidhjen</button>

      <div class="next-lesson" id="nextLesson" style="display:none;">
        <a href="lesson2.html" class="next-btn">Shko te mÃ«simi tjetÃ«r â†’</a>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-bottom">
      <p>Â© 2025 MÃ«so Programimin | Krijuar nga <span>Qelsim Rraci</span></p>
    </div>
  </footer>

  <script>
    let wrongAttempts = 0;

    // Notification logic
    function showNotification(message, type = "error") {
      const notif = document.getElementById("notification");
      notif.textContent = message;
      notif.className = `notification show ${type === "success" ? "success" : ""}`;
      setTimeout(() => notif.classList.remove("show"), 3500);
    }

    // Load Monaco Editor
    require.config({ paths: { vs: "https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs" }});
    require(["vs/editor/editor.main"], function () {
      window.editor = monaco.editor.create(document.getElementById("editor"), {
        value: `// Shkruaj kodin tÃ«nd kÃ«tu\n\n\n\n\n\n\n\n\n//Rezultati i pritshem: \n//Alban \n//Kosove`,
        language: "javascript",
        theme: "vs-dark",
        fontSize: 16,
        automaticLayout: true,
        minimap: { enabled: false },
      });
    });

    // Check code correctness
    function checkCode(output) {
      const normalized = output.replace(/\s+/g, "").toLowerCase();
      return normalized.includes("") && normalized.includes("kosov");
    }

    // Run button
    document.getElementById("run-btn").addEventListener("click", () => {
      const code = window.editor.getValue();
      const output = document.getElementById("output");
      output.textContent = "";

      const logs = [];
const originalLog = console.log;
console.log = (...args) => {
  logs.push(args.join(" "));
  logs.push("\n"); // Add a new line after every console.log
};


      try {
        eval(code);
        const finalOutput = logs.join("");

        output.innerHTML = finalOutput || "<em>(nuk ka output)</em>";

        if (checkCode(finalOutput)) {
          showNotification("âœ… SaktÃ«! ShkÃ«lqyeshÃ«m!", "success");
          wrongAttempts = 0;
          document.getElementById("nextLesson").style.display = "block";
          document.getElementById("showAnswerBtn").style.display = "none";
        } else {
          wrongAttempts++;
          showNotification("âŒ PÃ«rgjigje e pasaktÃ«! Provo pÃ«rsÃ«ri.");
          if (wrongAttempts >= 3) {
            document.getElementById("showAnswerBtn").style.display = "inline-block";
          }
        }
      } catch (err) {
        showNotification("âš ï¸ Gabim nÃ« kod: " + err.message);
      }
      console.log = originalLog;
    });

    // Show answer button
    document.getElementById("showAnswerBtn").addEventListener("click", () => {
      window.editor.setValue(`let emri = "Alban";\nlet vendi = "KosovÃ«";\nconsole.log(emri);\nconsole.log(vendi);`);
      showNotification("âœ… Zgjidhja u vendos nÃ« editor!", "success");
    });
  </script>
</body>
</html>
