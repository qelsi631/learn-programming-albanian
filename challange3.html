<!DOCTYPE html>
<html lang="sq">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sfida 2.1: PÃ«rdorimi i typeof() | MÃ«so Programimin</title>

  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet" href="css/challanges.css" />
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs/loader.min.js"></script>

  <style>
    /* Notification */
    .notification {
      position: fixed;
      top: 80px;
      right: 20px;
      background: #ff4444;
      color: #fff;
      padding: 12px 20px;
      border-radius: 8px;
      font-weight: 600;
      opacity: 0;
      transform: translateY(-10px);
      transition: all 0.3s ease;
      z-index: 9999;
    }
    .notification.show {
      opacity: 1;
      transform: translateY(0);
    }
    .notification.success {
      background: #00c985;
    }

    /* Show Answer Button */
    .show-answer-btn {
      display: none;
      background: #555;
      color: #fff;
      padding: 8px 16px;
      border-radius: 6px;
      margin-top: 12px;
      cursor: pointer;
      border: none;
      transition: 0.2s;
    }
    .show-answer-btn:hover {
      background: #777;
    }
  </style>
</head>

<body>
  <!-- Navbar -->
  <header class="navbar">
    <div class="navbar-left">
      <img src="imgs/coding-removebg-preview.png" alt="Logo" class="logo-icon">
      <span class="logo-text">MÃ«so Programimin</span>
    </div>
  </header>

  <!-- Notification -->
  <div id="notification" class="notification"></div>

  <!-- Challenge -->
  <main class="challenge-container vertical-layout">
    <!-- Instructions -->
    <section class="instructions-top">
      <h2 class="challenge-title">ğŸ§  Sfida 2.1: PÃ«rdorimi i typeof()</h2>
      <p>
        NÃ« kÃ«tÃ« ushtrim, do tÃ« pÃ«rdorÃ«sh funksionin <code>typeof()</code> pÃ«r tÃ« kuptuar llojin e tÃ« dhÃ«nave qÃ« mban njÃ« variabÃ«l.
      </p>
      <p><strong>Detyra:</strong></p>
      <ol>
        <li>Krijo njÃ« variabÃ«l <code>emri</code> (string) dhe njÃ« variabÃ«l <code>mosha</code> (number).</li>
        <li>PÃ«rdor <code>console.log()</code> pÃ«r tÃ« printuar <code>typeof emri</code> dhe <code>typeof mosha</code>.</li>
      </ol>
      <p>Kur tÃ« jesh gati, kliko <strong>â€œEkzekuto Kodinâ€</strong> pÃ«r tÃ« parÃ« rezultatet.</p>
    </section>

    <!-- Editor -->
    <section class="editor-bottom">
      <h2 class="challenge-title">ğŸ’» Shkruaj Kodin TÃ«nd</h2>
      <div id="editor" class="monaco-editor"></div>
      <button id="run-btn">Ekzekuto Kodin</button>
      <div id="output"></div>
      <button id="showAnswerBtn" class="show-answer-btn">Shiko zgjidhjen</button>

      <div class="lesson-nav top-nav">
        <a href="challange2.html" class="nav-btn back-btn">â† Kthehu te Sfida 2</a>
        <a href="lesson3.html" class="nav-btn next-btn" id="nextLesson" style="display:none;">Vazhdo te MÃ«simi 3 â†’</a>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-bottom">
      <p>Â© 2025 MÃ«so Programimin | Krijuar nga <span>Qelsim Rraci</span></p>
    </div>
  </footer>

  <script>
    let wrongAttempts = 0;

    // Notification helper
    function showNotification(message, type = "error") {
      const notif = document.getElementById("notification");
      notif.textContent = message;
      notif.className = `notification show ${type === "success" ? "success" : ""}`;
      setTimeout(() => notif.classList.remove("show"), 3500);
    }

    // Load Monaco Editor with hints
    require.config({ paths: { vs: "https://cdnjs.cloudflare.com/ajax/libs/monaco-editor/0.45.0/min/vs" } });
    require(["vs/editor/editor.main"], function () {
      window.editor = monaco.editor.create(document.getElementById("editor"), {
        value: `// Shkruaj kodin tÃ«nd kÃ«tu ğŸ‘‡\n\n\n\n\n\n//Rezultati i pritshem:\n//string\n//number`,
        language: "javascript",
        theme: "vs-dark",
        fontSize: 16,
        automaticLayout: true,
        minimap: { enabled: false },
      });
    });

    // Check correctness
    function checkOutput(output) {
      const normalized = output.replace(/\s+/g, "").toLowerCase();
      return normalized.includes("string") && normalized.includes("number");
    }

    // Run Code
    document.getElementById("run-btn").addEventListener("click", () => {
      const code = window.editor.getValue();
      const output = document.getElementById("output");
      output.textContent = "";

      const logs = [];
      const originalLog = console.log;
      console.log = (...args) => {
        logs.push(args.map(v => String(v)).join(" "));
        logs.push("\n");
      };

      try {
        eval(code);
        const finalOutput = logs.join("");
        output.textContent = finalOutput || "(nuk ka output)";

        if (checkOutput(finalOutput)) {
          showNotification("âœ… SaktÃ«! Ke pÃ«rdorur typeof siÃ§ duhet!", "success");
          wrongAttempts = 0;
          document.getElementById("nextLesson").style.display = "inline-block";
          document.getElementById("showAnswerBtn").style.display = "none";
        } else {
          wrongAttempts++;
          showNotification("âŒ PÃ«rgjigje e pasaktÃ«! Provo pÃ«rsÃ«ri.");
          if (wrongAttempts >= 3) {
            document.getElementById("showAnswerBtn").style.display = "inline-block";
          }
        }
      } catch (err) {
        showNotification("âš ï¸ Gabim nÃ« kod: " + err.message);
      }

      console.log = originalLog;
    });

    // Show Answer logic
    document.getElementById("showAnswerBtn").addEventListener("click", () => {
      window.editor.setValue(
        `let emri = "Alban";\nlet mosha = 20;\n\nconsole.log(typeof emri);\nconsole.log(typeof mosha);`
      );
      showNotification("âœ… Zgjidhja u vendos nÃ« editor!", "success");
    });
  </script>
</body>
</html>
